<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sleep Outside | Discussion Forum</title>
    <link rel="stylesheet" href="../css/style.css" />
    <script src="../js/forum.js" type="module"></script>
  </head>
  <body>
    <header class="divider" id="main-header"></header>
    <main class="divider">
      <section class="forum list">
        <ol>
        </ol>
        <a href="#">
          <textarea class="threadnamearea" placeholder="Name your thread here"></textarea>
          <textarea class="usernamearea" placeholder="Username"></textarea>
          <textarea class="replyarea" placeholder="Write your comment here!"></textarea>
        <button>Create a new thread</button>
      </a>
      </section>
    </main>
    <footer id="main-footer"></footer>
  </body>
  <script type="text/javascript">


examplethreads = [
    {
        title: "Indoor camping?",
        id: "0",
        content: "I love this sort of thing, but I'm also a homebody. can anyone recommend play tents to use for the indoors instead of having to be out with the bugs?",
        username: "citySlicker",
        comments: [
            {
                username: "Moderator",
                content: "You know the website name is Sleep Outside. right?"

            },
            {
                username: "citySlicker",
                content: "Yeah. So?"
            }
        ]
    },
    {
    title: "Pricepoints",
    id: "1",
    content: "Five hundred dollars for some of these tents?",
    username: "frugality",
    comments: [
        {
            username: "Moderator",
            content: "That is the suggested retail price."

        },
        {
            username: "frugality",
            content: "it's ridiculous."
        }
    ]
}
];
if (localStorage.getItem('threads')) {
  threads = JSON.parse(localStorage.getItem('threads'));
} else {
threads = examplethreads;
  localStorage.setItem('threads', JSON.stringify(threads))
}
var orderedlist = document.querySelector('ol');
function addThread(thread) {
    var threadhtml = `
    <li class="row">
    <a href="./thread.html?${thread.id}">
    <h2 class="thread-title-mainpage">
        ${thread.title}
    </h2>
    <div class="bottom">
    <p id="content">
        ${thread.content}
    </p>
    <p class="info" id="Author"> 
        ${thread.username}
    </p>
    <p class="info" id="comments">${thread.comments.length} comments</p>
    </div>
    </a>
    </li>
    `
    orderedlist.insertAdjacentHTML('beforeend', threadhtml);

}
for (let thread of threads) {
    addThread(thread);
}
var postbutton = document.querySelector('button');
postbutton.addEventListener('click', function() {
    var replytext = document.querySelector('.replyarea');
    var usernametext = document.querySelector('.usernamearea');
    var threadnametext = document.querySelector('.threadnamearea');
    if (threadnametext.value.length != 0 && replytext.value.length != 0 && usernametext.value.length != 0) {
    var post = {
        title: threadnametext.value,
        id: threads.length,
        content: replytext.value, 
        username: usernametext.value,
        comments: []
    }
    threads.push(post);
    localStorage.setItem('threads', JSON.stringify(threads));
    addThread(post);
    replytext.value = '';
    threadnametext.value = '';
} else {
  window.alert("All fields must be filled!")
}

})

  </script>
</html>
